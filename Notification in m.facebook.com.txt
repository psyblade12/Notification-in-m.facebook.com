// ==UserScript==
// @name         m.facebook.com sound notification
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  Play sound and show notification when a mess comes.
// @author       Psyblade
// @match        https://m.facebook.com/*
// @grant        none
// ==/UserScript==

//Disable page visibility API, để khi chuyển trang hoặc thu xuống thì vẫn nhận được âm thanh báo.
Object.defineProperties(document.wrappedJSObject,{ 'hidden': {value: false}, 'visibilityState': {value: 'visible'} });
window.addEventListener( 'visibilitychange', evt => evt.stopImmediatePropagation(), true);

//Add event listener cho element thứ 2 của các class có tên _59tg, khi có sự thay đổi thì sẽ kích hoạt event
document.getElementsByClassName("_59tg")[2].addEventListener("DOMNodeInserted", function(){
        var b =  document.getElementsByClassName("_59tg");
    //Nếu như có tin nhắn - Số tin nhắn khác 0
        if(b[2].innerHTML != "0")
        {
                //Khai báo địa chỉ của file âm thanh. Nếu muốn có thể tự chỉnh thành file khác.
                var audio = new Audio('https://raw.githubusercontent.com/psyblade12/Notification-in-m.facebook.com/master/CasioChime.mp3');
                audio.play();
        }
});
